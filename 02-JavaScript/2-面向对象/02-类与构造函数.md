## 一 类与实例

面向对象思想中最重要的概念就是类与实例：

- 类：是描述一些相同事务的模板。JS 已经原生提供了大量的类，如 Math 类、Date 类、String 类、Object 类等，这是面向对象 封装 思想的体现。
- 实例：即对象，是类的具体表现者，比如我们称呼人为人类，那么张三这个人即是人类的具体实例，在 JS 中，`var date = new Date()` 这个 date 即是 Date 类的实例。

## 二 类与对象的使用

在 JS 中，创建一个类依赖于构造函数、原型两个条件，示例：

```js
// 创建 Person 类

// 构造函数：名称与类名一致，且大写
function Person(name, age) {
  this.name = name; // 不添加 this限定就会让name造成污染：创建的多个不同实例，其name都一样
  this.age = age;
}

// 构造函数的原型：用于挂载类的实例方法
Person.prototype.sing = function () {
  console.log(this.name + "在唱歌...");
};
```

上述代码完整、标准展现了 JS 中的一个类 Person，一个标准的类包括两部分：

- 构造函数：首字母大写，与类名相同，内部包含该类的通用属性
- 构造函数的原型：每个构造函数都具备的属性 prototype，内部包含该类的通用方法

有了类，现在就可以通过类创建对象了：

```js
var p1 = new Person("张三", 30);
console.log(p.age); // 30
p1.sing(); // 张三在唱歌...

var p2 = new Person("张三", 30);
console.log(p.age); // 30
p2.sing(); // 张三在唱歌...
```

构造函数中的 this，其实就代表了对象的实例！

## 三 成员

我们通常称呼一个类的字段、函数为成员，类的成员通常有两部分：

- 属性：即类包含的一些键值
- 方法：即类包含的一些函数。用类或对象来调用的函数，我们一般称之为方法

方法可以挂载在构造函数的原型上，也可以直接挂载在构造函数上，那么此时就可以分为：

- 实例方法：由类创建的实例对象调用，如示例中的 sing 方法
- 静态方法：也称为类方法，由类本身调用，挂载在构造函数上

静态方法示例：

```js
Person.eat = function () {
  console.log("eat....");
};

Person.eat();
```

## 四 构造函数

### 4.1 构造函数概念

> 构造函数：用来描述对象内部数据结构

注意：构造函数只是对对象内部数据的描述，并没有达到创建对象的作用，`new`操作才是创建了对象。

### 4.2 原型

方法也是对象内部数据的一部分，既然构造函数用来描述对象的内部的数据，为什么不把方法也写在构造函数内部，而是要额外写在原型中呢？

```js
function Person(name) {
  this.name = name;
  // 直接写在构造函数中的实例方法
  this.speak = function () {
    console.log(this.name + "在说话...");
  };
}

Person.prototype.sing = function () {
  console.log(this.name + "在唱歌...");
};

var p1 = new Person("张三");
p1.sing(); // 张三在唱歌...
p1.speak(); // 张三在说话...

var p2 = new Person("李四");
p2.sing(); // 李四在唱歌...
p2.speak(); // 李四在说话...

console.log(p1.sing == p2.sing); // true
console.log(p1.speak == p2.speak); // false
```

我们发现实例方法如果直接写在构造函数后，不同的实例方法在判断相等时候，结果是 false。这是因为每次通过 new 创建一个全新的实例时，都等于重新申请了新的内存，并将构造函数的数据拷贝进该内存，这也造成了 p1 和 p2 的 speak 方法不相等，也导致了无故多创建了一个函数内存！

而原型不会被拷贝，因为他是构造函数自身的属性，不是实例上的属性，为了统一处理这些不会被拷贝的数据，JS 规定将这些数据都存放在构造函数的 prototype 属性上。

由上也可以看出，原型上也是可以存储非函数的普通变量数据的，但是这种数据无法被实例改变，只能像静态方法那样，通过类名修改。一般不推荐在面向对象思想中这样做。

### 五 总结

**一般将属性放在构造函数中，方法放在原型中！**，因为：

- 构造函数内部的函数，在每次创建实例的时候都会在内存中新建一次该函数，比如一个 Person()类 new10 次就会产生 10 个 run 方法，会严重造成资源浪费。但是在 protoype 属性上挂载的方法则不会，因为原型本身其实也是一个对象，所有的实例都会引用这一个对象上的方法。
- 原型上书写属性字段，会造成 new 出的实例的该字段值都是一样的，无法定制化。比如上述实例 new 出的对象其 sex 属性都为 ”男“
